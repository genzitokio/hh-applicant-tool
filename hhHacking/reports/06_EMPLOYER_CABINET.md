# HH.RU Employer Cabinet Analysis

## Summary
Анализ JS бандлов работодательского кабинета hh.ru. Найдены критические системы: AI Assistant для найма, автоматические приглашения, скоринг кандидатов, антифрод и фингерпринтинг.

---

## 1. Employer Suspicious States

### Статусы работодателей
```javascript
e.EmployerSuspicious = "EMPLOYER_SUSPICIOUS";
e.EmployerNotSuspicious = "EMPLOYER_NOT_SUSPICIOUS";
e.BlacklistedRegistration = "BLACKLISTED_REGISTRATION";
e.SuspiciousVacancyInvitation = "SUSPICIOUS_VACANCY_INVITATION";
```

### Причины блокировки вакансий
```javascript
e.VacancyBlockedDuePaidServices = "VACANCY_BLOCKED_DUE_PAID_SERVICES";
e.VacancyBlockedDueBadDescription = "VACANCY_BLOCKED_DUE_BAD_DESCRIPTION";
e.VacancyBlockedDueTwoInOne = "VACANCY_BLOCKED_DUE_TWO_IN_ONE";
e.VacancyBlockedDueTraining = "VACANCY_BLOCKED_DUE_TRAINING";
e.VacancyBlockedDueCaptionMissing = "VACANCY_BLOCKED_DUE_CAPTION_MISSING";
e.VacancyBlockedDueModerator = "VACANCY_BLOCKED_DUE_MODERATOR";
e.VacancyBlockedDueRelocateFromBelarus = "VACANCY_BLOCKED_DUE_RELOCATE_FROM_BELARUS";
e.VacancyBlockedDueReplacement = "VACANCY_BLOCKED_DUE_REPLACEMENT";
e.VacancyBlockedDueForeignLanguage = "VACANCY_BLOCKED_DUE_FOREIGN_LANGUAGE";
```

---

## 2. AI Assistant System

### Функционал
- **AI генерация вакансий**: `/employer/vacancy/create?draftId=${id}&generated=true`
- **AI анализ откликов**: `/employer/vacancyresponses/ai-assistant?vacancyId=${id}`
- **AI приглашения**: `aiAssistantInviteSkillStatistics`, `aiAssistantInviteHoldAlertVisible`

### Redux State
```javascript
aiAssistantInviteSkillStatistics: autoGeneratedReducer(null),
aiAssistantLimits: Ee,
isAiAssistantAvailable: autoGeneratedReducer(false),
aiAssistantResponseAnalyzerSkillResults: _e.y,
aiAssistantResponseAnalyzerSkillStatistics: Re.s,
aiAssistantResponseAnalyzerSkillTaskStatus: je.g,
canInteractWithAIAssistant: autoGeneratedReducer(false),
```

---

## 3. Auto-Invitation System

### Endpoints
- `/employer/vacancyresponses/autoinvite?vacancyId=${id}`
- `/employer/automation?automation=autoInvitation`

### Disable Reasons
```javascript
noServices: "employer.candidates.autoinvite.notification.disableReason.noServices"
noQuotas: "employer.candidates.autoinvite.notification.disableReason.noQuotas"
finished: "employer.candidates.autoinvite.notification.disableReason.finished"
```

### Events
```javascript
[zt.F.AutoInviteDisabled]: Dn,
[zt.F.AutoInviteEnabled]: Ln.X,
"UPDATE_EMPLOYER_AUTO_INVITE_VACANCIES"
```

---

## 4. Candidate Scoring & Relevance

### Scoring Parameters
```javascript
e.RelevanceOfCandidatesFromResumeDatabase = "relevanceOfCandidatesFromResumeDatabase";
orderBy: Relevance,
order_by: "relevance",
```

### Survey Assessment Points
```javascript
[ri.SiteConvenience],
[ri.AllowsToQuicklyFindEmployee],
[ri.SuitableForSearchingWorkers],
[ri.RelevanceOfCandidatesFromResumeDatabase],
[ri.ServiceJustifiesItsCost],
[ri.QualityOfSupportService]
```

### Resume Types
- `giftedResumes` - "подаренные" резюме
- `suitableResumes` - подходящие резюме
- `targetResumes` - целевые резюме
- `suitableResumesCountTotal`, `suitableResumesCountLastMonth`

---

## 5. Antifraud & Phishing Protection

### Antifraud Verdicts
```javascript
e.AntifraudVerdict = "antifraud_verdict";
e.FraudDetected = "FRAUD_DETECTED";
e.FraudBlockTerminateService = "FRAUD_BLOCK_TERMINATE_SERVICE";
```

### Phishing Info Modal
```javascript
// Endpoint для сброса phishing info
C._i.delete("/shards/employer/phishing_info");

// Modal keys
"employer.phishingInfo.modal.header"
"employer.phishingInfo.modal.textList.first"
"employer.phishingInfo.modal.textList.second"
"employer.phishingInfo.modal.textList.third"
```

### Redux State
```javascript
isShowPhishingModal: autoGeneratedReducer(false),
```

---

## 6. External Tracking SDKs

### TargetAds WebSDK
- **Host**: `https://eye.targetads.io`
- **Endpoint**: `/web/collect?...`
- **Собирает**: Yandex UID, Google Analytics CID, screen size, referrer
- **Storage**: `_tads${projectId}_cid`, `_tads${projectId}_yandexuid`
- **Events**: `page_view`, `event`, `add_to_cart`, `purchase`

### CPA Tracker SDK (iapSDK)
- **Cookie**: `iap.uid` (32 символа)
- **Endpoints**:
  - `/tracker/hit` - page views
  - `/tracker/event` - events (ADD_TO_CART, CONFIRM_ATTRIBUTION)
  - `/tracker/order` - orders
  - `/tracker/conversion` - conversions
- **Data**: URL, referrer, screen dimensions, random ID

### Firebase Messaging
```javascript
messagingSenderId: window.globalVars.firebaseMessagingSenderId,
projectId: window.globalVars.firebaseProjectId,
apiKey: window.globalVars.firebaseApiKey,
appId: window.globalVars.firebaseAppId
```

---

## 7. Security & Fingerprinting (remote_shared.js)

### Federation Modules
```javascript
"./security": fingerprint promises
"./security/secureportal.test_ver": test version
"./security/secureportal.v29": production v29
"./security/fingerprint2-1.5.1": Fingerprint2 library
```

### Fingerprint Promises
```javascript
securePortalFingerprintPromise: deferred promise
fingerprintPromise: deferred promise
```

---

## 8. Employer API Endpoints

### Account & Billing
```
/employer/account
/employer/account/expenditures
/employer/account/money
/employer/account/replenishments
/employer/account/services
/employer/cart
/employer/cart/payment
/employer/invoice/change_activation_type
/employer/invoice/paylink
```

### Vacancies
```
/employer/vacancy/create
/employer/vacancy/restore/${id}
/employer/vacancies
/employer/vacancies/archived
/employer/vacancies/drafts
/employer/vacancyresponses?vacancyId=${id}
/employer/vacancyresponses/autoinvite
/employer/vacancyresponses/ai-assistant
```

### Resumes & Candidates
```
/employer/targetresumes
/employer/resumefolders
/employer/resumefolders/search
/employer/candidates
```

### Settings & Documents
```
/employer/settings
/employer/settings/subscription
/employer/settings/email
/employer/documents
/employer/documents-management
/employer/verification
/employer/verificationacts
/employer/financial-documents
```

### Internal Shards
```
/shards/employer/clickme_replenishment
/shards/employer/phishing_info
/shards/employer/vacancies/get_vacancy_name_typesuggest
/shards/employer/create_cart
/shards/employer/clickme_auto_campaign/*
/shards/employer/overspending
/shards/employer/divisions
/shards/employer/banners_widget_make_seen
/shards/employer/last_search/remove
/shards/employer/open_employer_make_read
/shards/employer/old_employer_free_prolongation_modal_viewed
/shards/employer/old_employer_without_services_modal_viewed
```

### Additional Check
```
DELETE /employer/additional_check
```

---

## 9. Trusted Employer System

### Trust Flags
```javascript
e.employerInfo.isTrusted
e.vacancyView.company["@trusted"]
onlyTrusted: true/false
```

---

## 10. Interesting Findings

### Belarus-related blocking
```javascript
VacancyBlockedDueRelocateFromBelarus
```

### IT Accreditation
```javascript
analyticsElementName: "employer_it_accreditation_notice"
```

### Talantix Integration
```javascript
"responses_talantix_segment"
```

### ZP Migration (Zarplata.ru)
```javascript
buttonLink: "/employer/zp_employer_migrate"
```

### AppMetrica Tracking
```javascript
"https://4284841.redirect.appmetrica.yandex.com/?appmetrica_tracking_id=533228366812154364"
```

---

## 11. CANDIDATE RANKING SYSTEM (Deep Analysis)

### NeuroSort System - AI классификация кандидатов
```javascript
e.NeuroSuitable = "Подходят";         // AI считает подходящим
e.NeuroConsider = "Можно рассмотреть"; // AI рекомендует рассмотреть
e.NeuroNotNow = "Не сейчас";           // AI отклоняет
e.NeuroInProgress = "В обработке";     // AI обрабатывает

// Категории в массиве для итерации
const m = [p.NeuroSuitable, p.NeuroConsider, p.NeuroNotNow, p.NeuroInProgress];
```

### AI Analyzer Criteria
```javascript
// Mandatory vs Optional критерии
e.Mandatory = "mandatory";  // Обязательные требования
e.Optional = "optional";    // Желательные требования

// AI analytics events
sendHHEventButtonClick("neuro_mandatory_requirements", {...})
sendHHEventButtonClick("neuro_optional_requirements", {...})
sendHHEventButtonClick("neuro_requirements_add", {...})
sendHHEventButtonClick("neuro_requirements_change_save", {...})
sendHHEventButtonClick("neuro_resume_card_requirement", {...})
```

### NeuroResponse API Endpoints
```
/employer/vacancyresponses/neuroresponse
/employer/vacancyresponses/neuroresponse_statistics
/employer/vacancyresponses/ai-assistant
```

---

## 12. APPLICANT SUSPICIOUS STATES

### SuspiciousState Enum
```javascript
e.NotSuspicious = "NOT_SUSPICIOUS";
e.Suspicious = "SUSPICIOUS";
e.TrustedSuspicious = "TRUSTED_SUSPICIOUS";     // Доверенный, но подозрительный
e.SuspiciousRemovalPending = "SUSPICIOUS_REMOVAL_PENDING"; // Ожидает снятия подозрения
```

### Antifraud Salary Check
```javascript
e.MakeSalaryNotSuspicious = "MAKE_SALARY_NOT_SUSPICIOUS";
```

---

## 13. RESPONSE SOURCE TYPES

```javascript
e.IncomingCall = "INCOMING_CALL";
e.MissedCall = "MISSED_CALL";
e.ResponseFromChat = "RESPONSE_FROM_CHAT";
e.AutoSurveyInProgress = "AUTO_SURVEY_IN_PROGRESS";
e.ResponseFromVr = "RESPONSE_FROM_VR";
e.AutoInvite = "AUTO_INVITE";
e.AwaitingReply = "AWAITING_REPLY";
e.AutoResponse = "AUTO_RESPONSE";
e.MoreResponses = "MORE_THEN_ONE_TOPIC_WITH_THIS_RESUME";
e.ResponseFromClickmeCpa = "RESPONSE_FROM_CLICKME_CPA";  // Платная реклама
e.NeuroResponse = "NEURO_RESPONSE";  // Автоответ от AI
e.AutoResponseHhPro = "AUTO_RESPONSE_HH_PRO";  // HH Pro функционал
```

### AI Auto-Response Types
```javascript
e.AiAutoResponseCoverLetter = "AI_AUTO_RESPONSE_COVER_LETTER";
e.AutoResponseCoverLetter = "AUTO_RESPONSE_COVER_LETTER";
```

---

## 14. SEARCH FILTER CLUSTERS (Resume Ranking Factors)

### Основные кластеры фильтрации
```javascript
// Личные данные
Age, Gender, Citizenship, WorkTicket

// Профессиональные
Experience, ProfessionalRole, ProfessionalExperience,
IndustryExperience, Skill, VerifiedSkills, EducationLevel, University

// Зарплата и условия
Salary, Employment, Schedule, WorkFormat,
WorkScheduleByDays, WorkingHours, BusinessTripReadiness

// Локация
Area, District, Metro, Relocation, ResidencePolygon, Neighbours

// Языки
Language, VerifiedLanguages

// Специальные
JobSearchStatus, Label, DriverLicenseTypes, SearchField, ExcludedText
```

### Sorting Options
```javascript
e.Relevance = "RELEVANCE";  // По релевантности (default)
e.Relevance = "relevance";
// Другие: PublicationTime, SalaryDesc, SalaryAsc
```

### API Cluster Endpoints
```
/shards/search/resume/clusters?${params}
/shards/search/vacancy/clusters?${params}
/shards/employer/vacancy/suitable_resumes
```

---

## 15. CANDIDATE PIPELINE (Funnel System)

### Funnel Stage Management
```javascript
// Candidate workflow states
suitableWorkflowCollections    // Подходящие кандидаты
unsuitableWorkflowCollections  // Неподходящие кандидаты

// Funnel structure
funnel: {
  funnelId: 0,
  stages: [],
  stage: null
}

// Employer state tracking
e.employerState
e.EMPLOYER_STATE_WITHOUT_SUBSTATE
totalCandidatesByEmployerState
totalUnreadCandidatesByEmployerState
```

### Funnel API
```
/employer/vacancyresponses/funnel
```

---

## 16. VISIBILITY & ACCESS CONTROL

### Resume Visibility System
```javascript
resumeVisibilityEmployerBlacklist      // Черный список работодателей
resumeVisibilityEmployerWhitelist      // Белый список работодателей
resumeVisibilityEmployerSearchResultsBlacklist  // Скрытие из поиска (blacklist)
resumeVisibilityEmployerSearchResultsWhitelist  // Видимость в поиске (whitelist)
```

### Access Type Filtering
```javascript
e.ExcludeViewedByUserId = "exclude_viewed_by_user_id";
e.ExcludeViewedByEmployerId = "exclude_viewed_by_employer_id";
```

### Resume Blocked States
```javascript
entryType: "resume_blocked"
// Уведомления о блокировке
"supernova.notification.resume.blocked.description"
"supernova.notification.resume.blocked.button"
```

---

## 17. ACTIVITY SCORING SYSTEM

### User Activity Score (Gamification)
```javascript
const D = T.userActivityScore ?? 0;       // Текущий скор активности
const L = T.userActivityScoreChange ?? 0; // Изменение скора
const V = (P?.eventScores) ?? [];         // Скоры за события
```

### Response Streak Badges (7 levels)
```javascript
responseStreakSuccessBadge1 through responseStreakSuccessBadge7
// CSS классы для каждого уровня
"response-streak-success-badge-1--ErY_no8Ho3UcWwUg"
...
"response-streak-success-badge-7--qoFNeTMozcgDVyxu"
```

---

## 18. BOT DETECTION FLAGS

### isBot System
```javascript
isBot: autoGeneratedReducer(false)  // Redux state

// Captcha integration
(e.recaptcha?.isBot) ? "RECAPTCHA_IS_BOT" : ...
(e.hhcaptcha?.isBot) || (e.recaptcha?.isBot)

// Bot detected actions
if (i.isBot) { ... }  // Показ капчи
className: l.isBot ? "" : "g-hidden"  // Скрытие элементов
```

---

## 19. EMPLOYER RATING SYSTEM

### HH Rating Integration
```javascript
// External rating URLs
"https://rating.hh.ru/poll"
"https://rating.hh.ru/history/rating"
"https://rating.hh.ru/history/rating2024/?utm_source=..."

// Rating notifications
e.HHRating = "hhrating";
e.HHRatingRegistration = "hhrating.registration.invitation";
e.HHRatingVoteInvitation = "hhrating.vote.invitation";
```

---

## 20. BLACKLIST/WHITELIST ENDPOINTS

### Applicant Blacklists
```
/applicant/blacklist/vacancy      # Черный список вакансий
/applicant/blacklist/employer     # Черный список работодателей
/applicant/favorite_vacancies     # Избранные вакансии
```

### Employer Resume Lists
```
/employer/favorite_resumes        # Избранные резюме
/employer/target_resumes          # Целевые резюме
```

---

## Attack Vectors

### Original
1. **AI Assistant Abuse** - попытка извлечь данные через AI endpoint
2. **Auto-invite Manipulation** - исследование лимитов и обхода квот
3. **Fingerprint Bypass** - анализ secureportal.v29 для обхода
4. **Shard Endpoints** - неавторизованный доступ к /shards/employer/*
5. **Trust System** - манипуляция isTrusted флагом
6. **CPA Tracker** - эксфильтрация через iapSDK endpoints
7. **TargetAds Data** - корреляция идентификаторов

### Candidate Ranking Vectors (NEW)
8. **NeuroSort Bypass** - исследование как обойти AI фильтрацию
9. **SuspiciousState Manipulation** - исследование смены статуса
10. **Activity Score Gaming** - накрутка userActivityScore
11. **Visibility Control Abuse** - обход blacklist/whitelist систем
12. **Funnel Stage Manipulation** - изменение employerState напрямую
13. **Bot Detection Evasion** - обход isBot проверок
14. **Cluster Filter Bypass** - манипуляция параметрами фильтров

---

## 21. LIVE RUNTIME DATA (Chrome MCP Extraction)

### Employer Status Object
```javascript
employerStatus: {
  category: "PRIVATE_INDIVIDUAL",
  suspiciousState: "NOT_SUSPICIOUS",  // Антифрод статус работодателя
  state: "APPROVED",
  countryId: "1",
  areaId: "1",
  accepted: true,
  hasDocuments: false,
  noVacancies: false
}
```

### Search Session Tracking
```javascript
searchSessionId: "b92195a3-189a-4e6e-9eb0-b5edcb9452e1"  // UUID сессии поиска
searchRequestId: "177021159769307ddae19a745c975022"     // ID конкретного запроса
```

### Hidden Resume Attributes (Live Data)
```javascript
resume._attributes = {
  id: "268735433",
  parentResumeId: "236808627",    // Связанное родительское резюме
  hash: "73262e0c00100493c900bda49257795a467a45",  // Уникальный хэш
  hhid: "12179789",               // Внутренний ID пользователя
  permission: "view_without_contacts",  // Уровень доступа
  status: "approved",             // Статус модерации
  lastEditTime: 1769916071754,
  lang: "RU",
  source: "flexible_resume_builder",
  isSearchable: true,             // Видимость в поиске
  hasPublicVisibility: false,
  sitePlatform: "HEADHUNTER",
  tags: [],
  user: "21197115",               // ID пользователя-владельца
  updated: 1770187194463,
  vacancySearchLastUsageDate: 1770187187,  // Последний поиск вакансий
  moderated: "2026-02-01T06:41:14+03:00",
  update_timeout: 14400000        // 4 часа в ms
}
```

### predictedSalary - AI Predicted Salary (HIDDEN FROM USERS)
```javascript
// Резюме с указанной зарплатой 300,000 ₽
resume.salary = [{amount: 300000, currency: "RUR"}]

// AI предсказанная зарплата (скрыто от пользователя!)
resume.predictedSalary = [{amount: 208942, currency: "RUR"}]

// Связанные резюме того же пользователя с разными предсказаниями:
linkedResumes[0].predictedSalary = [{amount: 258546, currency: "RUR"}]  // Senior Frontend Developer
linkedResumes[1].predictedSalary = [{amount: 268179, currency: "RUR"}]  // Senior React developer
linkedResumes[3].predictedSalary = [{amount: 224831, currency: "RUR"}]  // Staff Frontend Engineer
linkedResumes[4].predictedSalary = [{amount: 196591, currency: "RUR"}]  // Team Lead
linkedResumes[5].predictedSalary = [{amount: 305593, currency: "RUR"}]  // Tech Lead
```

### fieldsViewStatus - Access Control
```javascript
fieldsViewStatus: [{
  contactViewStatus: {
    resumeId: "268735433",
    viewStatus: "DENIED_NO_FA",  // Доступ к контактам закрыт (нет финансового счёта)
    resumeContactsOpening: {
      throughCiv: false,
      pfp: { available: false }
    }
  },
  vacancyPermissions: ["VIEW_DESIRABLE_COMPENSATION", "VIEW_CONTACTS"],
  rolePermissions: ["ViewDesirableCompensation", "ContactApplicant"]
}]
```

### jobSearchStatus Cluster (Live Counts)
```javascript
jobSearchStatusCluster.groups = {
  active_search:     { count: 7545, title: "Активно ищет работу" },
  looking_for_offers:{ count: 2866, title: "Рассматривает предложения" },
  has_job_offer:     { count: 239,  title: "Предложили работу, решает" },
  accepted_job_offer:{ count: 91,   title: "Вышел на новое место" },
  not_looking_for_job:{ count: 1586, title: "Не ищет работу" },
  unknown:           { count: 282,  title: "Без статуса поиска" }
}
```

### Label Cluster - Special Filters
```javascript
labelCluster.groups = {
  only_with_photo:            { count: 7937, title: "Есть фото" },
  only_with_vehicle:          { count: 2402, title: "Есть автомобиль" },
  exclude_viewed_by_user_id:  { count: null, title: "Скрыть просмотренные мной за год" },
  exclude_viewed_by_employer_id: { count: null, title: "Скрыть просмотренные всей компанией за год" },
  only_in_responses:          { count: null, title: "Только кандидаты из откликов и приглашений" }
}
```

### Real-time Activity Indicators
```javascript
resume.isOnline = true                                    // Онлайн прямо сейчас
resume.lastActivityTime = "2026-02-04T16:25:06.209+03:00" // Последняя активность
resume.jobSearchStatus.lastChangeTime = "2026-01-29T19:01:24.813302Z"
```

### Internal Shards APIs
```javascript
GET /shards/employer/churn         // {"isChurned": false} - отток работодателя
GET /shards/employer/overspending  // {"vacancyWithAutoUpdateViews": []} - автообновление
GET /api/fl/idgib-w-hh             // Fingerprint API (GIB защита от ботов)
```

---

## 22. LINKED RESUMES SYSTEM

### Resume Hierarchy
```javascript
// Пользователь может иметь несколько связанных резюме
resume.linkedResumes = [
  { id: "268735391", title: "Senior Frontend Developer", predictedSalary: 258546 },
  { id: "236808627", title: "Senior React developer", predictedSalary: 268179 },
  { id: "223116871", title: "React developer (EN)", predictedSalary: null },
  { id: "267909494", title: "Staff Frontend Engineer", predictedSalary: 224831 },
  { id: "143932011", title: "Team Lead", predictedSalary: 196591 },
  { id: "223117101", title: "Tech Lead", predictedSalary: 305593 },
  { id: "259641472", title: "Руководитель разработки", predictedSalary: 255621 }
]

// Иерархия через parentResumeId
143932011 (Team Lead)
  └── 223117101 (Tech Lead)
      └── 259641472 (Руководитель разработки)
  └── 223116871 (React developer EN)
      └── 223117170 → 236808627 (Senior React)
          └── 268735391 (Senior Frontend)
          └── 268735433 (Frontend-разработчик)
          └── 267909494 (Staff Engineer)
```

---

## 23. GIB FINGERPRINT SYSTEM

### API Endpoint
```
GET /api/fl/idgib-w-hh
```

### Request Headers
```
x-cfids: BtRyQYDWUo2X7K4YgW/5hv...   // Client fingerprint ID
x-gib-fgsscgib-w-hh: 35nXb708fe38cd14b6470f1a0b468d20515c9aea
x-gib-gsscgib-w-hh: /Tn+HL3YM3z5c0xeeI077LQS3+66H2G1gkqg...
```

### Response
```json
{
  "status": "success",
  "error": null,
  "data": {
    "cfids": "SRJy0/3iy3EhenUK1imiwiSoIBhq..."  // Renewed fingerprint token
  }
}
```

### Related Cookies
```
cfidsgib-w-hh     // Client fingerprint cookie
gsscgib-w-hh      // Global session cookie
fgsscgib-w-hh     // Frontend global session
__zzatgib-w-hh    // Anti-bot tracking
```

---

## 24. NEGOTIATION LINKS STRUCTURE

### Invite Actions
```javascript
resume.negotiationLinks = {
  invite: {
    stateLinks: [],
    defaultLink: "/employer/negotiations/change_topic?r=${resume_hash}"
  },
  inviteAnother: {
    stateLinks: [],
    defaultLink: "/employer/negotiations/change_topic?r=${resume_hash}&allVacancies=True&toAnother=True"
  }
}
```

---

## 25. FULL CLUSTER LIST (26 Dimensions)

```javascript
clusterKeys = [
  "driver_license_types",
  "area",
  "education_level",
  "job_search_status",
  "district",
  "business_trip_readiness",
  "metro",
  "language",
  "verified_skills",
  "verified_languages",
  "gender",
  "schedule",
  "experience",
  "professional_role",
  "employment",
  "skill",
  "salary",
  "age",
  "label",
  "citizenship",
  "filter_exp_industry",
  "filter_exp_period",
  "relocation",
  "university",
  "work_ticket",
  "profession_experience"
]
```

---

## 26. MULTI-ACCOUNT DETECTION & CROSS-ACCOUNT LINKING

### Механизм определения связанных аккаунтов

HH.ru определяет когда **РАЗНЫЕ аккаунты** (разные `hhid`) принадлежат одному человеку через:

1. **Телефон/Email** - при регистрации или входе с телефоном/email, который уже привязан к другому аккаунту
2. **Browser Fingerprint** - GIB fingerprint система (`/api/fl/idgib-w-hh`)

### Error Keys, Триггерящие Multi-Account Flow

```javascript
// При логине возвращается ошибка с флагом
response.data.isMultiAccountCreation = true;
response.data.error.key = "MULTIACCOUNT_CREATION_REQUIRED";
response.data.error.key = "EMPLOYER_NOT_ALLOWED";
response.data.employerLoginURL = "..."; // URL для входа в существующий employer аккаунт
```

### API Endpoints

```
POST /account/login/by_code
  - username: phone/email
  - code: OTP
  - remember: true
  - accountType: "APPLICANT" | undefined
  - operationType: "otp_auth"

POST /multiaccount_grouping/reset_employer_password
  - code: OTP код
  - operationType: "OTP_GENERATE"

GET /account/connect/(register|merge|phone-request)
GET /account/connect/merge_by_code
```

### Логика Детекции (IndexPage-route:5985-6020)

```javascript
// 1. Попытка логина
await C._i.postFormData("/account/login/by_code", { username, code, operationType: "otp_auth" });

// 2. Сервер возвращает ошибку
const errorKey = response.data.error.key;
const isMultiAccount = response.data.isMultiAccountCreation;

// 3. Условия для multi-account flow
if (isMultiAccount && (errorKey === "EMPLOYER_NOT_ALLOWED" || errorKey === "MULTIACCOUNT_CREATION_REQUIRED")) {
  // Запускает процедуру связывания аккаунтов
  await C._i.post("/multiaccount_grouping/reset_employer_password", { code, operationType: "OTP_GENERATE" });
}
```

### OperationType Enum

```javascript
nt.b = {
  EmployerOtpAuth,              // employer_otp_auth
  ApplicantOtpAuth,             // applicant_otp_auth
  MultiaccountGroupingEmailVerificationEmployer  // для связывания email работодателя
}
```

### Redux State для Multi-Account

```javascript
isMultiAccount: autoGeneratedReducer(false),
multiAccountCreationPayload: autoGeneratedReducer(null),
session: {
  hasExtraAccounts: false,  // Есть ли связанные аккаунты
  isMultiAccount: false
},
autologin: {
  reloginUrl: "",
  sameUserUrl: ""  // URL для того же пользователя
}
```

### UI Components

```javascript
// Шаг регистрации для связывания аккаунтов
"SignUp/Form/MultiAccountGroupingStep/MultiAccountGroupingStepComponent"

// Переключение между аккаунтами
case "switchAccountEmployer":
case "switchAccountApplicant":

// Меню переключения
"employer.employerProfile.popup.switchAccount"
"applicant.supernova.menuItem.switchAccountApplicant"
```

### Сценарий Cross-Account Detection

```
1. Пользователь А имеет аккаунт соискателя с телефоном +7900...
2. Пользователь А регистрирует аккаунт работодателя с тем же телефоном
3. Сервер определяет совпадение по телефону
4. Возвращает MULTIACCOUNT_CREATION_REQUIRED
5. Запускается flow связывания аккаунтов
6. После связывания: session.hasExtraAccounts = true
7. Появляется UI для переключения между аккаунтами
```

### Security Implications

- **Утечка информации**: При попытке регистрации с чужим телефоном/email система сообщает, что аккаунт уже существует
- **Account Enumeration**: Можно определить зарегистрированные телефоны/email
- **Link Discovery**: Можно узнать связаны ли два аккаунта (employer + applicant)

---

## Files Analyzed
- `App.js` (deobfuscated) - 1.4M
- `vendors.js` (deobfuscated) - 2.3M
- `IndexPage-route.js` (deobfuscated) - 396K
- `firebase.js` (deobfuscated) - 87K
- `TargetAds_WebSDK.js` - tracking SDK
- `cpa_tracker_sdk.js` - CPA tracking
- `remote_shared.js` - federation + fingerprint
- `security.js` - fingerprint promises
